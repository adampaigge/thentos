<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Thentos.Test.Core</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Thentos-Test-Core.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">thentos-tests-0.0.1.1: Test infrastructure for thentos-*</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Thentos.Test.Core</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">test users</a></li><li><a href="#g:2">Sample data for making services, contexts, and personas</a></li><li><a href="#g:3">runners</a></li><li><a href="#g:4">set up state</a></li><li><a href="#g:5">misc</a></li></ul></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:testUserForms">testUserForms</a> :: [<a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:UserFormData">UserFormData</a>]</li><li class="src short"><a href="#v:testUsers">testUsers</a> :: [<a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:User">User</a>]</li><li class="src short"><a href="#v:testUser">testUser</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:User">User</a></li><li class="src short"><a href="#v:testUid">testUid</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:UserId">UserId</a></li><li class="src short"><a href="#v:testHashedSecret">testHashedSecret</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:HashedSecret">HashedSecret</a> <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:ServiceKey">ServiceKey</a></li><li class="src short"><a href="#v:addTestUser">addTestUser</a> :: <a href=""/>Int</a> -&gt; <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:Action">Action</a> <a href=""/>Void</a> s (<a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:UserId">UserId</a>, <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:UserFormData">UserFormData</a>, <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:User">User</a>)</li><li class="src short"><a href="#v:initializeTestUsers">initializeTestUsers</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:Action">Action</a> <a href=""/>Void</a> s [(<a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:UserId">UserId</a>, <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:UserFormData">UserFormData</a>, <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:User">User</a>)]</li><li class="src short"><a href="#v:encryptTestSecret">encryptTestSecret</a> :: <a href=""/>ByteString</a> -&gt; <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:HashedSecret">HashedSecret</a> a</li><li class="src short"><a href="#v:servId">servId</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:ServiceId">ServiceId</a></li><li class="src short"><a href="#v:cxtName">cxtName</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:ContextName">ContextName</a></li><li class="src short"><a href="#v:cxtDesc">cxtDesc</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:ContextDescription">ContextDescription</a></li><li class="src short"><a href="#v:cxtUrl">cxtUrl</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:ProxyUri">ProxyUri</a></li><li class="src short"><a href="#v:persName">persName</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:PersonaName">PersonaName</a></li><li class="src short"><a href="#v:withLogger">withLogger</a> :: <a href=""/>IO</a> a -&gt; <a href=""/>IO</a> a</li><li class="src short"><a href="#v:withLogger-39-">withLogger'</a> :: <a href=""/>IO</a> a -&gt; <a href=""/>IO</a> a</li><li class="src short"><a href="#v:withNoisyLogger">withNoisyLogger</a> :: <a href=""/>IO</a> a -&gt; <a href=""/>IO</a> a</li><li class="src short"><a href="#v:withNoisyLogger-39-">withNoisyLogger'</a> :: <a href=""/>IO</a> a -&gt; <a href=""/>IO</a> a</li><li class="src short"><a href="#v:_withLogger">_withLogger</a> :: <a href=""/>Bool</a> -&gt; <a href=""/>IO</a> a -&gt; <a href=""/>IO</a> a</li><li class="src short"><a href="#v:withWebDriver">withWebDriver</a> :: WD r -&gt; <a href=""/>IO</a> r</li><li class="src short"><a href="#v:withWebDriver-39-">withWebDriver'</a> :: WD r -&gt; <a href=""/>IO</a> r</li><li class="src short"><a href="#v:withWebDriverAt-39-">withWebDriverAt'</a> :: <a href=""/>String</a> -&gt; <a href=""/>Int</a> -&gt; WD r -&gt; <a href=""/>IO</a> r</li><li class="src short"><a href="#v:withFrontend">withFrontend</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Config.html#t:HttpConfig">HttpConfig</a> -&gt; <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a> -&gt; <a href=""/>IO</a> r -&gt; <a href=""/>IO</a> r</li><li class="src short"><a href="#v:withFrontend-39-">withFrontend'</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Config.html#t:HttpConfig">HttpConfig</a> -&gt; <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a> -&gt; <a href=""/>IO</a> r -&gt; <a href=""/>IO</a> r</li><li class="src short"><a href="#v:withBackend">withBackend</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Config.html#t:HttpConfig">HttpConfig</a> -&gt; <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a> -&gt; <a href=""/>IO</a> r -&gt; <a href=""/>IO</a> r</li><li class="src short"><a href="#v:withBackend-39-">withBackend'</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Config.html#t:HttpConfig">HttpConfig</a> -&gt; <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a> -&gt; <a href=""/>IO</a> r -&gt; <a href=""/>IO</a> r</li><li class="src short"><a href="#v:withFrontendAndBackend">withFrontendAndBackend</a> :: <a href=""/>String</a> -&gt; (<a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a> -&gt; <a href=""/>IO</a> r) -&gt; <a href=""/>IO</a> r</li><li class="src short"><a href="#v:withFrontendAndBackend-39-">withFrontendAndBackend'</a> :: <a href=""/>String</a> -&gt; (<a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a> -&gt; <a href=""/>IO</a> r) -&gt; <a href=""/>IO</a> r</li><li class="src short"><a href="#v:createActionState">createActionState</a> :: <a href=""/>String</a> -&gt; <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Config.html#t:ThentosConfig">ThentosConfig</a> -&gt; <a href=""/>IO</a> <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a></li><li class="src short"><a href="#v:createDb">createDb</a> :: <a href=""/>String</a> -&gt; <a href=""/>IO</a> (Pool Connection)</li><li class="src short"><a href="#v:loginAsGod">loginAsGod</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a> -&gt; <a href=""/>IO</a> (<a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:ThentosSessionToken">ThentosSessionToken</a>, [Header])</li><li class="src short"><a href="#v:decodeLenient">decodeLenient</a> :: FromJSON a =&gt; LBS -&gt; <a href=""/>Either</a> <a href=""/>String</a> a</li><li class="src short"><a href="#v:..-61-">(..=)</a> :: ST -&gt; ST -&gt; Pair</li></ul></div><div id="interface"><h1 id="g:1">test users</h1><div class="top"><p class="src"><a name="v:testUserForms" class="def">testUserForms</a> :: [<a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:UserFormData">UserFormData</a>]</p></div><div class="top"><p class="src"><a name="v:testUsers" class="def">testUsers</a> :: [<a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:User">User</a>]</p></div><div class="top"><p class="src"><a name="v:testUser" class="def">testUser</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:User">User</a></p></div><div class="top"><p class="src"><a name="v:testUid" class="def">testUid</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:UserId">UserId</a></p></div><div class="top"><p class="src"><a name="v:testHashedSecret" class="def">testHashedSecret</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:HashedSecret">HashedSecret</a> <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:ServiceKey">ServiceKey</a></p></div><div class="top"><p class="src"><a name="v:addTestUser" class="def">addTestUser</a> :: <a href=""/>Int</a> -&gt; <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:Action">Action</a> <a href=""/>Void</a> s (<a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:UserId">UserId</a>, <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:UserFormData">UserFormData</a>, <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:User">User</a>)</p><div class="doc"><p>Add a single test user (with fast scrypt params) from <code><a href="Thentos-Test-Core.html#v:testUsers">testUsers</a></code> to the database and return
 it.</p></div></div><div class="top"><p class="src"><a name="v:initializeTestUsers" class="def">initializeTestUsers</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:Action">Action</a> <a href=""/>Void</a> s [(<a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:UserId">UserId</a>, <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:UserFormData">UserFormData</a>, <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:User">User</a>)]</p><div class="doc"><p>Create a list of test users (with fast scrypt params), store them in the database, and return
 them for use in test cases.</p></div></div><div class="top"><p class="src"><a name="v:encryptTestSecret" class="def">encryptTestSecret</a> :: <a href=""/>ByteString</a> -&gt; <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:HashedSecret">HashedSecret</a> a</p></div><h1 id="g:2">Sample data for making services, contexts, and personas</h1><div class="top"><p class="src"><a name="v:servId" class="def">servId</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:ServiceId">ServiceId</a></p></div><div class="top"><p class="src"><a name="v:cxtName" class="def">cxtName</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:ContextName">ContextName</a></p></div><div class="top"><p class="src"><a name="v:cxtDesc" class="def">cxtDesc</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:ContextDescription">ContextDescription</a></p></div><div class="top"><p class="src"><a name="v:cxtUrl" class="def">cxtUrl</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:ProxyUri">ProxyUri</a></p></div><div class="top"><p class="src"><a name="v:persName" class="def">persName</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:PersonaName">PersonaName</a></p></div><h1 id="g:3">runners</h1><div class="top"><p class="src"><a name="v:withLogger" class="def">withLogger</a> :: <a href=""/>IO</a> a -&gt; <a href=""/>IO</a> a</p></div><div class="top"><p class="src"><a name="v:withLogger-39-" class="def">withLogger'</a> :: <a href=""/>IO</a> a -&gt; <a href=""/>IO</a> a</p><div class="doc"><p>Run an action, logging everything with <code>DEBUG</code> level to <code>./everything.log</code>.</p></div></div><div class="top"><p class="src"><a name="v:withNoisyLogger" class="def">withNoisyLogger</a> :: <a href=""/>IO</a> a -&gt; <a href=""/>IO</a> a</p></div><div class="top"><p class="src"><a name="v:withNoisyLogger-39-" class="def">withNoisyLogger'</a> :: <a href=""/>IO</a> a -&gt; <a href=""/>IO</a> a</p><div class="doc"><p>this is a workaround for the fact that log file contents is not included in the output of
 failing test cases.  If you replace the call to <code><a href="Thentos-Test-Core.html#v:withLogger">withLogger</a></code> with one ot <code><a href="Thentos-Test-Core.html#v:withNoisyLogger">withNoisyLogger</a></code> in a
 test, everything will go to stderr immediately.</p><p>FIXME: include log contents in failing test cases.</p><p>FIXME: while we are at it, it would be really cool (and not that hard) to provide a log handler
 that logs into a <code>Chan</code>, and expose the Chan to the tests.  that would make it easy to use log
 file contents to formulate tests.</p></div></div><div class="top"><p class="src"><a name="v:_withLogger" class="def">_withLogger</a> :: <a href=""/>Bool</a> -&gt; <a href=""/>IO</a> a -&gt; <a href=""/>IO</a> a</p></div><div class="top"><p class="src"><a name="v:withWebDriver" class="def">withWebDriver</a> :: WD r -&gt; <a href=""/>IO</a> r</p></div><div class="top"><p class="src"><a name="v:withWebDriver-39-" class="def">withWebDriver'</a> :: WD r -&gt; <a href=""/>IO</a> r</p><div class="doc"><p>Start and shutdown webdriver on localhost:4451, running the action in between.</p></div></div><div class="top"><p class="src"><a name="v:withWebDriverAt-39-" class="def">withWebDriverAt'</a> :: <a href=""/>String</a> -&gt; <a href=""/>Int</a> -&gt; WD r -&gt; <a href=""/>IO</a> r</p><div class="doc"><p>Start and shutdown webdriver on the specified host and port, running the
 action in between.</p></div></div><div class="top"><p class="src"><a name="v:withFrontend" class="def">withFrontend</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Config.html#t:HttpConfig">HttpConfig</a> -&gt; <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a> -&gt; <a href=""/>IO</a> r -&gt; <a href=""/>IO</a> r</p></div><div class="top"><p class="src"><a name="v:withFrontend-39-" class="def">withFrontend'</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Config.html#t:HttpConfig">HttpConfig</a> -&gt; <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a> -&gt; <a href=""/>IO</a> r -&gt; <a href=""/>IO</a> r</p><div class="doc"><p>Start and shutdown the frontend in the specified <code>HttpConfig</code> and with the
 specified DB, running an action in between.</p></div></div><div class="top"><p class="src"><a name="v:withBackend" class="def">withBackend</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Config.html#t:HttpConfig">HttpConfig</a> -&gt; <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a> -&gt; <a href=""/>IO</a> r -&gt; <a href=""/>IO</a> r</p></div><div class="top"><p class="src"><a name="v:withBackend-39-" class="def">withBackend'</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Config.html#t:HttpConfig">HttpConfig</a> -&gt; <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a> -&gt; <a href=""/>IO</a> r -&gt; <a href=""/>IO</a> r</p><div class="doc"><p>Run a <code>hspec-wai</code> <code>Session</code> with the backend <code>Application</code>.</p></div></div><div class="top"><p class="src"><a name="v:withFrontendAndBackend" class="def">withFrontendAndBackend</a> :: <a href=""/>String</a> -&gt; (<a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a> -&gt; <a href=""/>IO</a> r) -&gt; <a href=""/>IO</a> r</p></div><div class="top"><p class="src"><a name="v:withFrontendAndBackend-39-" class="def">withFrontendAndBackend'</a> :: <a href=""/>String</a> -&gt; (<a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a> -&gt; <a href=""/>IO</a> r) -&gt; <a href=""/>IO</a> r</p><div class="doc"><p>Sets up DB, frontend and backend, creates god user, runs an action that
 takes a DB, and tears down everything, returning the result of the action.</p></div></div><h1 id="g:4">set up state</h1><div class="top"><p class="src"><a name="v:createActionState" class="def">createActionState</a> :: <a href=""/>String</a> -&gt; <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Config.html#t:ThentosConfig">ThentosConfig</a> -&gt; <a href=""/>IO</a> <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a></p><div class="doc"><p>Create an <code>ActionState</code> with a connection to an empty DB and the specified
 config.</p></div></div><div class="top"><p class="src"><a name="v:createDb" class="def">createDb</a> :: <a href=""/>String</a> -&gt; <a href=""/>IO</a> (Pool Connection)</p><div class="doc"><p>Create a connection to an empty DB.</p><p>FIXME: the tests shouldn't have to pick a database name.  it should work like <code><a href="Thentos-Test-Core.html#v:withLogger">withLogger</a></code> in
 that it finds a free suitable database name, and garbage-collects the database when the test is
 done.</p></div></div><div class="top"><p class="src"><a name="v:loginAsGod" class="def">loginAsGod</a> :: <a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Action-Core.html#t:ActionState">ActionState</a> -&gt; <a href=""/>IO</a> (<a href="/thentos/gh-pages/haddock/doc/x86_64-linux-ghc-7.10.2/thentos-core-0.0.1.1/html/Thentos-Types.html#t:ThentosSessionToken">ThentosSessionToken</a>, [Header])</p></div><h1 id="g:5">misc</h1><div class="top"><p class="src"><a name="v:decodeLenient" class="def">decodeLenient</a> :: FromJSON a =&gt; LBS -&gt; <a href=""/>Either</a> <a href=""/>String</a> a</p><div class="doc"><p>Like <code><a href="Data-Aeson.html#v:decode">decode</a></code> but allows all JSON values instead of just
 objects and arrays.</p><p>FIXME: upgrade to aeson &gt;= 0.10 and use <code>eitherDecode</code> instead of this: See
 4b370592242d4e4367ca46d852109c3927210f4b.  for this to work, we need to either upgrade pronk
 (criterion in particular) benchmarking or, preferably, factor it out into a separate package.</p></div></div><div class="top"><p class="src"><a name="v:..-61-" class="def">(..=)</a> :: ST -&gt; ST -&gt; Pair</p><div class="doc"><p>This is convenient if you have lots of string literals with <code>-XOverloadedStrings</code> but do not
 want to do explicit type signatures to avoid type ambiguity.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>